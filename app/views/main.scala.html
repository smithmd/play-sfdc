@(title: String, data: String, fullList: String)(content: Html)

<!DOCTYPE html>

<html>
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
        <link rel="stylesheet" media="all" href="@routes.Assets.at("stylesheets/charts.css")">
        <script type="application/javascript" src="https://www.google.com/jsapi"></script>
        <script type="application/javascript">
            var fullDBList = @Html(fullList);
            console.log('full dashboard list');
            console.log(fullDBList);
            var dashboard = @Html(data);
            console.log('single dashboard:');
            console.log(dashboard);

            // Load the Visualization API and the required packages
            google.load('visualization', '1.0', {'packages':['table', 'corechart', 'gauge']});

            // Set a callback to run when the Google Visualization API is loaded.
            google.setOnLoadCallback(drawCharts);

            function drawCharts() {
//                drawCampaignNewGiftsTable();
//                drawFundraisingByFundCategory();
                drawTable('01aG0000001j7IbIAI', 'Opportunity.Gift_Committed_Date__c',1);
                drawTable('01aG0000001j7IfIAI', 'FK_cv__Designation__c.Fund_Category_for_THE_Campaign__c',1);
                drawTable('01aG0000001j7IeIAI', 'CLOSE_DATE',2);
//                draw01aJ00000001utIIAQ();
//                draw01aJ00000001uthIAA();
//                draw01aJ00000001utiIAA();
//                draw01aJ00000001utjIAA();
//                draw01aJ00000001utkIAA();
            }

            function appendChartToColumn(data, options, title, col, chart_type) {
                // create and append fieldset
                var fs = document.createElement('fieldset');
                // create and append legend
                var legend = document.createElement('legend');
                legend.innerHTML = title;
                fs.appendChild(legend);

                // create and append div that holds chart
                var chart_div = document.createElement('div');
                chart_div.classList.add('chart');
                if (chart_type !== null) {
                    chart_div.classList.add(chart_type);
                }

                fs.appendChild(chart_div);

                var chart = new google.visualization.Table(chart_div);
                chart.draw(data, options);

                // add fieldset to appropriate column
                document.getElementById('col'+col).appendChild(fs);
            }

            // helper functions to get the reports from the huge disgusting json
            function getReportIndex(report_id) {
                var report_index = -1;

                dashboard.componentData.forEach(function (element, index) {
                    if (element.componentId == report_id) {
                        report_index = index;
                    }
                });

                return report_index;
            }

            function getReport(report_id) {
                var report = null;

                dashboard.componentData.forEach(function (element, index) {
                    if (element.componentId == report_id) {
                        report = dashboard.componentData[index];
                    }
                });

                return report;
            }

            function getReportByIndex(report_index) {
                return dashboard.componentData[report_index];
            }

            function getReportTitleByIndex(report_index) {
                return dashboard.dashboardMetadata.components[report_index].header;
            }

            function getColumnLabels(obj) {
                var columnLabels = [];
                for (var columnInfo in obj) {
                    if (obj.hasOwnProperty(columnInfo)) {
                        var index = columnInfo.replace(/FORMULA/,'');
                        columnLabels[index-1] = obj[columnInfo].label;
                    }
                }

                return columnLabels;
            }

            function getAggregateByIndex(index, report) {
                return report.reportResult.reportMetadata.aggregates.indexOf('FORMULA' + (index+1));
            }

            function getGroupings(arr) {
                var groupings = [];
                for (var i = 0; i < arr.length; i++) {
                    groupings.push(arr[i].label);
                }

                return groupings;
            }

            function drawTable(report_id, groupingInfo, column) {

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                // init google chart
                var data = new google.visualization.DataTable();

                var columnLabels = getColumnLabels(report.reportResult.reportExtendedMetadata.aggregateColumnInfo);

                var groupings = getGroupings(report.reportResult.groupingsDown.groupings);
                var colCount = columnLabels.length;

                data.addColumn('string', report.reportResult.reportExtendedMetadata.groupingColumnInfo[groupingInfo].label);
                var i;
                for ( i = 0; i < colCount; i++) {
                    data.addColumn('number', columnLabels[i]);
                }

                var factMap = report.reportResult.factMap;

                var colsOverOneMil = Array.apply(null, Array(colCount)).map(Number.prototype.valueOf,0);

                // add data rows
                for ( i = 0; i < groupings.length; i++) {
                    var row = [groupings[i]];
                    for (var j = 0; j < colCount; j++) {
                        var index = getAggregateByIndex(j,report);
                        var value = factMap[i + "!T"].aggregates[index].value;
                        if (value > 1000) {
                            colsOverOneMil[index] = 1;
                            value = value / 1000000;
                        }
                        row.push(value);
                    }
                    data.addRows([row]);
                }

                // add aggregate data row
                var row = ['Total'];
                for ( i = 0; i < colCount; i++) {
                    var index = getAggregateByIndex(i,report);
                    var value = factMap["T!T"].aggregates[index].value;
                    if (value > 1000) {
                        colsOverOneMil[index] = 1;
                        value = value / 1000000;
                    }
                    row.push(value);
                }
                data.addRows([row]);

                // format numbers to dollars
                var millions_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.#'}
                );
//                var thousands_formatter = new google.visualization.NumberFormat(
//                    {prefix: '$', suffix: 'K', pattern: '#,###.#'}
//                );
                for (i = 0; i < colsOverOneMil.length; i++) {
                    millions_formatter.format(data,colsOverOneMil[i]+1);
                }

                var options = {
                    'title':dashboard.dashboardMetadata.attributes.dashboardName,
                    showRowNumber: false
                };

                appendChartToColumn(data, options, getReportTitleByIndex(report_index),column,'table');
            }

            // functions to actually draw charts
            function drawFundraisingByFundCategory() {
                var report_id = '01aG0000001j7IfIAI';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                console.log(report_index);
                var report = getReportByIndex(report_index);

                var factMap = report.reportResult.factMap;

                // init google chart
                var data = new google.visualization.arrayToDataTable(
                    [
                        ['Label', 'Value'],
                        ['Total (Millions)', factMap["T!T"].aggregates[0].value / 1000000]
                    ]
                );

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.##'}
                );
                currency_formatter.format(data,1);

                var options = {
                    width:400, height: 300,
                    redFrom: 0, redTo: 25,
                    yellowFrom:25, yellowTo:50,
                    minorTicks: 3,
                    majorTicks: ['0', 25, 50, 75],
                    min:0,
                    max:75,
                    animation: {
                        startup: true,
                        duration: 500,
                        easing: 'inAndOut'
                    }
                };

                appendChartToColumn(data, options, getReportTitleByIndex(report_index),1,'table');
            }

            function draw01aJ00000001utIIAQ() {
                var report_id = '01aJ00000001utIIAQ';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                // get title by index

                // init google chart
                var data = new google.visualization.DataTable();

                // get column labels and groupings
                var columnLabels = getColumnLabels(report.reportResult.reportExtendedMetadata.aggregateColumnInfo);
                var groupings = getGroupings(report.reportResult.groupingsDown.groupings);

                data.addColumn('string', report.reportResult.reportExtendedMetadata.groupingColumnInfo['FK_cv__Designation__c.Fund_Category_for_THE_Campaign__c'].label);
                data.addColumn('number', columnLabels[2]);
                data.addColumn('number', columnLabels[0]);

                var factMap = report.reportResult.factMap;

                for (var i = 0; i < groupings.length; i++) {
                    data.addRows([[ groupings[i],
                    factMap[i + "!T"].aggregates[2].value / 1000000,
                    factMap[i + "!T"].aggregates[0].value / 1000000]]);
                }

                data.addRows([['Total', factMap["T!T"].aggregates[2].value / 1000000, factMap["T!T"].aggregates[0].value / 1000000]]);

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.#'}
                );
                currency_formatter.format(data,1);
                currency_formatter.format(data,2);

                var options = {
                    'title':dashboard.dashboardMetadata.attributes.dashboardName,
                    showRowNumber: false,
                    width:400
                };

                var chart = new google.visualization.Table(document.getElementById(report_id));
                chart.draw(data, options);

                // set title
                document.getElementById('title_'+report_id ).innerHTML = getReportTitleByIndex(report_index);
            }

            function draw01aJ00000001uthIAA() {
                var report_id = '01aJ00000001uthIAA';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                // get title by index

                // init google chart
                var data = new google.visualization.DataTable();

                // get column labels and groupings
                var columnLabels = getColumnLabels(report.reportResult.reportExtendedMetadata.aggregateColumnInfo);
                var groupings = getGroupings(report.reportResult.groupingsDown.groupings);

                data.addColumn('string', report.reportResult.reportExtendedMetadata.groupingColumnInfo['CLOSE_DATE'].label);
                data.addColumn('number', columnLabels[2]);
                data.addColumn('number', columnLabels[0]);
                data.addColumn('number', columnLabels[1]);

                var factMap = report.reportResult.factMap;

                for (var i = 0; i < groupings.length; i++) {
                    data.addRows([[ groupings[i],
                    factMap[i + "!T"].aggregates[3].value,
                    factMap[i + "!T"].aggregates[1].value / 1000000,
                    factMap[i + "!T"].aggregates[2].value / 1000000]]);
                }

                data.addRows([['Total', factMap["T!T"].aggregates[3].value, factMap["T!T"].aggregates[1].value / 1000000, factMap["T!T"].aggregates[2].value / 1000000]]);

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.#'}
                );
                currency_formatter.format(data,2);
                currency_formatter.format(data,3);

                var options = {
                    'title':dashboard.dashboardMetadata.attributes.dashboardName,
                    showRowNumber: false,
                    width:400
                };

                var chart = new google.visualization.Table(document.getElementById(report_id));
                chart.draw(data, options);

                // set title
                document.getElementById('title_'+report_id ).innerHTML = getReportTitleByIndex(report_index);
            }

            function draw01aJ00000001utiIAA() {
                var report_id = '01aJ00000001utiIAA';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                var factMap = report.reportResult.factMap;

                // init google chart
                var data = new google.visualization.arrayToDataTable([
                    ['Label', 'Value'],
                    ['Total (Millions)', factMap["T!T"].aggregates[0].value / 1000000]
                ]);

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.##'}
                );
                currency_formatter.format(data,1);

                var options = {
                    width:400, height: 300,
                    redFrom: 0, redTo: 8,
                    yellowFrom:8, yellowTo:16,
                    minorTicks: 3,
                    majorTicks: ['0', 8, 16, 24],
                    min:0,
                    max:24,
                    animation: {
                        startup: true,
                        duration: 500,
                        easing: 'inAndOut'
                    }
                };

                var chart = new google.visualization.Gauge(document.getElementById(report_id));
                chart.draw(data, options);

                // set title
                document.getElementById('title_'+report_id).innerHTML = getReportTitleByIndex(report_index);
            }

            function draw01aJ00000001utjIAA() {
                var report_id = '01aJ00000001utjIAA';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                var factMap = report.reportResult.factMap;

                // init google chart
                var data = new google.visualization.arrayToDataTable([
                    ['Label', 'Value'],
                    ['Total (Millions)', factMap["T!T"].aggregates[0].value / 1000000]
                ]);

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.##'}
                );
                currency_formatter.format(data,1);

                var options = {
                    width:400, height: 300,
                    redFrom: 0, redTo: 1,
                    yellowFrom:1, yellowTo:2,
                    minorTicks: 3,
                    majorTicks: ['0', 1, 2, 3],
                    min:0,
                    max:3,
                    animation: {
                        startup: true,
                        duration: 500,
                        easing: 'inAndOut'
                    }
                };

                var chart = new google.visualization.Gauge(document.getElementById(report_id));
                chart.draw(data, options);

                // set title
                document.getElementById('title_'+report_id).innerHTML = getReportTitleByIndex(report_index);
            }

            function draw01aJ00000001utkIAA() {
                var report_id = '01aJ00000001utkIAA';

                // grabbing report to make code easier to read
                var report_index = getReportIndex(report_id);
                var report = getReportByIndex(report_index);

                var factMap = report.reportResult.factMap;

                // init google chart
                var data = new google.visualization.arrayToDataTable([
                    ['Label', 'Value'],
                    ['Total (Millions)', factMap["T!T"].aggregates[0].value / 1000000]
                ]);

                var currency_formatter = new google.visualization.NumberFormat(
                    {prefix: '$', suffix: 'M', pattern: '#,###.##'}
                );
                currency_formatter.format(data,1);

                var options = {
                    width:400, height: 300,
                    redFrom: 0, redTo: 1,
                    yellowFrom:1, yellowTo:2,
                    minorTicks: 3,
                    majorTicks: ['0', 1, 2, 3],
                    min:0,
                    max:3,
                    animation: {
                        startup: true,
                        duration: 500,
                        easing: 'inAndOut'
                    }
                };

                var chart = new google.visualization.Gauge(document.getElementById(report_id));
                chart.draw(data, options);

                // set title
                document.getElementById('title_'+report_id).innerHTML = getReportTitleByIndex(report_index);
            }
        </script>
    </head>
    <body>
        <div class="column" id="col1">
        </div>
        <div class="column" id="col2">
        </div>
        <div class="column" id="col3">
        </div>
    </body>
</html>
